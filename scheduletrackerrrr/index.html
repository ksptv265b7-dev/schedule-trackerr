<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Website</title>
<style>
/* --------- General Styles --------- */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #333; line-height: 1.6; }
header { background-color: #007bff; color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
.dropdown { position: relative; display: inline-block; }
.dropbtn { background-color: #007bff; color: white; padding: 0.5rem; border: none; cursor: pointer; font-weight: bold; }
.dropdown-content { display: none; position: absolute; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 1; }
.dropdown-content a { color: black; padding: 12px 16px; text-decoration: none; display: block; }
.dropdown-content a:hover {background-color: #f1f1f1}
.dropdown:hover .dropdown-content {display: block;}
.dropdown:hover .dropbtn {background-color: #0056b3;}
h1 { flex: 1; text-align: center; color: white; }
.login-container { display: flex; align-items: center; }
.login-container form { display: flex; align-items: center; }
.login-container label { margin: 0 0.5rem; }
.login-container input { padding: 0.3rem; margin: 0 0.2rem; }
main { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
section { margin-bottom: 2rem; padding: 1rem; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
h1, h2 { color: #007bff; }
footer { background-color: #343a40; color: white; text-align: center; padding: 1rem 0; margin-top: 2rem; }
.hero { text-align: center; padding: 2rem 0; }
.btn { display: inline-block; padding: 0.5rem 1rem; background-color: #28a745; color: white; text-decoration: none; border-radius: 4px; margin-top: 1rem; }
.btn:hover { background-color: #218838; }
form label { display: block; margin-bottom: 0.5rem; }
input { padding: 0.5rem; margin-bottom: 1rem; width: 100%; max-width: 300px; }
button { padding: 0.5rem 1rem; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
button:hover { background-color: #0056b3; }

/* --------- Chatbox --------- */
#chatbot-container { position: fixed; bottom: 20px; right: 20px; width: 300px; max-width: 90%; background: #fff; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: flex; flex-direction: column; overflow: hidden; z-index: 1000; }
#chatbot-header { background: #007bff; color: white; padding: 10px; text-align: center; font-weight: bold; cursor: pointer; }
#chatbot-body { display: none; flex-direction: column; }
#chatbot-messages { padding: 10px; height: 200px; overflow-y: auto; flex-grow: 1; background: #f1f1f1; }
#chatbot-input { padding: 8px; border: none; border-top: 1px solid #ccc; width: calc(100% - 60px); box-sizing: border-box; }
#chatbot-send { width: 50px; border: none; background: #007bff; color: white; cursor: pointer; }
#chatbot-container input:focus { outline: none; }
.chat-msg { margin-bottom: 8px; padding: 6px 10px; border-radius: 8px; max-width: 80%; word-wrap: break-word; }
.user-msg { background-color: #007bff; color: white; align-self: flex-end; }
.bot-msg { background-color: #e5e5e5; color: #333; align-self: flex-start; }
@media (max-width: 768px){ #chatbot-container { width: 90%; bottom: 10px; right: 5%; } }
</style>
</head>
<body>
<header>
    <div class="dropdown">
        <button class="dropbtn">Menu â–¼</button>
        <div class="dropdown-content">
            <a href="#home">Home</a>
            <a href="#about">About</a>
            <a href="#services">Services</a>
            <a href="#contact">Contact</a>
            <a href="#auth">Register</a>
        </div>
    </div>
    <h1>My Professional Website</h1>
    <div class="login-container">
        <form id="login">
            <label>Username: <input type="text" id="login-username" required></label>
            <label>Password: <input type="password" id="login-password" required></label>
            <button type="submit">Login</button>
        </form>
        <div id="user-panel" style="display:none;">
            Welcome, <span id="user-name"></span> 
            <button id="logout">Logout</button> 
            <button id="delete-account">Delete</button>
        </div>
    </div>
</header>

<main>
    <section id="home" class="hero">
        <h2>Welcome to My Website</h2>
        <p>This is a professional-looking website built with HTML and CSS. Discover more about what we offer.</p>
        <a href="#about" class="btn">Learn More</a>
    </section>
    <section id="about">
        <h2>About Us</h2>
        <p>We are a dedicated team providing high-quality services. Our mission is to deliver excellence in everything we do.</p>
    </section>
    <section id="services">
        <h2>Our Services</h2>
        <ul>
            <li>Web Development</li>
            <li>Design Consulting</li>
            <li>SEO Optimization</li>
            <li>Customer Support</li>
        </ul>
    </section>
    <section id="contact">
        <h2>Contact Us</h2>
        <p>Email: info@mywebsite.com</p>
        <p>Phone: (123) 456-7890</p>
    </section>
    <section id="auth">
        <h2>Register</h2>
        <form id="register">
            <label>Username: <input type="text" id="reg-username" required></label>
            <label>Password: <input type="password" id="reg-password" required></label>
            <button type="submit">Register</button>
        </form>
    </section>
</main>

<footer>
    <p>&copy; 2025 My Website. All rights reserved.</p>
</footer>

<!-- Chatbox -->
<div id="chatbot-container">
    <div id="chatbot-header">Chat with us!</div>
    <div id="chatbot-body">
        <div id="chatbot-messages"></div>
        <input type="text" id="chatbot-input" placeholder="Type your message...">
        <button id="chatbot-send">Send</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    // ---------- Safe Local Storage ----------
    let users = [];
    let currentUser = null;
    let conversationHistory = [];

    try { users = JSON.parse(localStorage.getItem('users')) || []; }
    catch { users = []; localStorage.setItem('users', JSON.stringify([])); }

    try { currentUser = JSON.parse(localStorage.getItem('currentUser')); }
    catch { currentUser = null; localStorage.setItem('currentUser', 'null'); }

    try { conversationHistory = JSON.parse(localStorage.getItem('chatHistory')) || []; }
    catch { conversationHistory = []; localStorage.setItem('chatHistory', JSON.stringify([])); }

    function saveUsers() { localStorage.setItem('users', JSON.stringify(users)); }
    function saveCurrentUser() { localStorage.setItem('currentUser', JSON.stringify(currentUser)); }

    // ---------- Login System ----------
    const loginForm = document.getElementById('login');
    const registerForm = document.getElementById('register');
    const userPanel = document.getElementById('user-panel');
    const userNameSpan = document.getElementById('user-name');

    function showLogin() {
        loginForm.style.display = 'flex';
        userPanel.style.display = 'none';
    }

    function showUserPanel() {
        loginForm.style.display = 'none';
        userPanel.style.display = 'flex';
        userNameSpan.textContent = currentUser ? currentUser.username : '';
    }

    if (currentUser) showUserPanel(); else showLogin();

    loginForm.addEventListener('submit', e => {
        e.preventDefault();
        const username = document.getElementById('login-username').value.trim();
        const password = document.getElementById('login-password').value.trim();
        const user = users.find(u => u.username === username && u.password === password);
        if (user) {
            currentUser = user;
            saveCurrentUser();
            alert("Login successful!");
            showUserPanel();
        } else {
            alert("Invalid username or password.");
        }
    });

    registerForm.addEventListener('submit', e => {
        e.preventDefault();
        const username = document.getElementById('reg-username').value.trim();
        const password = document.getElementById('reg-password').value.trim();
        if (users.find(u => u.username === username)) {
            alert("Username already exists.");
        } else {
            users.push({ username, password });
            saveUsers();
            alert("Registered successfully!");
            e.target.reset();
        }
    });

    document.getElementById('logout').addEventListener('click', () => {
        currentUser = null;
        saveCurrentUser();
        showLogin();
    });

    document.getElementById('delete-account').addEventListener('click', () => {
        if (confirm("Are you sure you want to delete your account?")) {
            users = users.filter(u => u.username !== currentUser.username);
            saveUsers();
            currentUser = null;
            saveCurrentUser();
            showLogin();
        }
    });

    // ---------- Chatbot ----------
    const chatMessages = document.getElementById('chatbot-messages');
    const chatInput = document.getElementById('chatbot-input');
    const chatSend = document.getElementById('chatbot-send');
    const chatBody = document.getElementById('chatbot-body');

    function addMessage(message, sender = 'user') {
        const msgDiv = document.createElement('div');
        msgDiv.className = sender === 'user' ? 'chat-msg user-msg' : 'chat-msg bot-msg';
        msgDiv.textContent = message;
        chatMessages.appendChild(msgDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        conversationHistory.push({ sender, message });
        if (conversationHistory.length > 50) conversationHistory.shift();
        localStorage.setItem('chatHistory', JSON.stringify(conversationHistory));
    }

    function botReply(text) {
        const t = text.toLowerCase();
        if (/hello|hi|hey/.test(t)) return "Hello! How can I assist you today?";
        if (/services/.test(t)) return "We offer Web Development, Design Consulting, SEO Optimization, and Customer Support.";
        if (/contact|email|phone/.test(t)) return "You can reach us at info@mywebsite.com or call (123) 456-7890.";
        if (/about/.test(t)) return "We are a dedicated team providing high-quality services.";
        if (/register|sign up/.test(t)) return "You can register using the form in the Register section.";
        if (/time/.test(t)) return `Current time is ${new Date().toLocaleTimeString()}`;
        if (/date/.test(t)) return `Today's date is ${new Date().toLocaleDateString()}`;
        return "I'm sorry, I don't fully understand. Can you rephrase your question?";
    }

    function botTyping(callback) {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'chat-msg bot-msg';
        typingDiv.textContent = 'Bot is typing...';
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        setTimeout(() => { typingDiv.remove(); callback(); }, 800 + Math.random() * 700);
    }

    conversationHistory.forEach(msg => addMessage(msg.message, msg.sender));

    chatSend.addEventListener('click', () => {
        const text = chatInput.value.trim();
        if (text === '') return;
        addMessage(text, 'user');
        chatInput.value = '';
        botTyping(() => addMessage(botReply(text), 'bot'));
    });

    chatInput.addEventListener('keypress', e => {
        if (e.key === 'Enter') chatSend.click();
    });

    document.getElementById('chatbot-header').addEventListener('click', () => {
        chatBody.style.display = chatBody.style.display === 'flex' ? 'none' : 'flex';
    });
});
</script>
</body>
</html>
